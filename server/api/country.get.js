export default defineEventHandler(async (event) => {
  const { name: queryName } = getQuery(event);
  const MAIN_URL = `https://restcountries.com/v3.1/name/${queryName}`;

  const data = await fetch(MAIN_URL);
  const dataJSON = await data.json();

  const {
    flags,
    name,
    population,
    region,
    subregion,
    capital,
    tld,
    currencies,
    languages,
  } = dataJSON[0];

  const response = {
    flag: flags.png,
    header: name.common,
    nativeName: '',
    population: population
      .toString()
      .replace(/\B(?=(\d{3})+(?!\d))/g, ','),
    region: region,
    subRegion: subregion,
    capital: capital[0],
    topLevelDomain: tld,
    currencies: '',
    languages: [''],
  };

  console.log('server', response);

  const obj1 = {
    name: {
      common: 'Argentina',
      official: 'Argentine Republic',
      nativeName: {
        grn: { official: 'Argentine Republic', common: 'Argentina' },
        spa: { official: 'RepÃºblica Argentina', common: 'Argentina' },
      },
    },
    tld: ['.ar'],
    cca2: 'AR',
    ccn3: '032',
    cca3: 'ARG',
    cioc: 'ARG',
    independent: true,
    status: 'officially-assigned',
    unMember: true,
    currencies: { ARS: { name: 'Argentine peso', symbol: '$' } },
    idd: { root: '+5', suffixes: ['4'] },
    capital: ['Buenos Aires'],
    altSpellings: ['AR', 'Argentine Republic', 'RepÃºblica Argentina'],
    region: 'Americas',
    subregion: 'South America',
    languages: { grn: 'GuaranÃ­', spa: 'Spanish' },
    translations: {
      ara: { official: 'Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†', common: 'Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†' },
      bre: { official: "Republik Arc'hantina", common: "Arc'hantina" },
      ces: { official: 'ArgentinskÃ¡ republika', common: 'Argentina' },
      cym: { official: 'Gweriniaeth yr Ariannin', common: 'Ariannin' },
      deu: { official: 'Argentinische Republik', common: 'Argentinien' },
      est: { official: 'Argentina Vabariik', common: 'Argentina' },
      fin: { official: 'Argentiinan tasavalta', common: 'Argentiina' },
      fra: { official: 'RÃ©publique argentine', common: 'Argentine' },
      hrv: { official: 'Argentinski Republika', common: 'Argentina' },
      hun: { official: 'Argentin KÃ¶ztÃ¡rsasÃ¡g', common: 'ArgentÃ­na' },
      ita: { official: 'Repubblica Argentina', common: 'Argentina' },
      jpn: { official: 'ã‚¢ãƒ«ã‚¼ãƒ³ãƒãƒ³å…±å’Œå›½', common: 'ã‚¢ãƒ«ã‚¼ãƒ³ãƒãƒ³' },
      kor: { official: 'ì•„ë¥´í—¨í‹°ë‚˜ ê³µí™”êµ­', common: 'ì•„ë¥´í—¨í‹°ë‚˜' },
      nld: { official: 'Argentijnse Republiek', common: 'ArgentiniÃ«' },
      per: { official: 'Ø¬Ù…Ù‡ÙˆØ±ÛŒ Ø¢Ø±Ú˜Ø§Ù†ØªÛŒÙ†', common: 'Ø¢Ø±Ú˜Ø§Ù†ØªÛŒÙ†' },
      pol: { official: 'Republika ArgentyÅ„ska', common: 'Argentyna' },
      por: { official: 'RepÃºblica Argentina', common: 'Argentina' },
      rus: { official: 'ĞÑ€Ğ³ĞµĞ½Ñ‚Ğ¸Ğ½ÑĞºĞ°Ñ Ğ ĞµÑĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°', common: 'ĞÑ€Ğ³ĞµĞ½Ñ‚Ğ¸Ğ½Ğ°' },
      slk: { official: 'ArgentÃ­nska republika', common: 'ArgentÃ­na' },
      spa: { official: 'RepÃºblica Argentina', common: 'Argentina' },
      swe: { official: 'Republiken Argentina', common: 'Argentina' },
      tur: { official: 'Arjantin Cumhuriyeti', common: 'Arjantin' },
      urd: { official: 'Ø¬Ù…ÛÙˆØ±ÛŒÛ Ø§Ø±Ø¬Ù†Ù¹Ø§Ø¦Ù†', common: 'Ø§Ø±Ø¬Ù†Ù¹Ø§Ø¦Ù†' },
      zho: { official: 'é˜¿æ ¹å»·å…±å’Œå›½', common: 'é˜¿æ ¹å»·' },
    },
    latlng: [-34, -64],
    landlocked: false,
    borders: ['BOL', 'BRA', 'CHL', 'PRY', 'URY'],
    area: 2780400,
    demonyms: {
      eng: { f: 'Argentine', m: 'Argentine' },
      fra: { f: 'Argentine', m: 'Argentin' },
    },
    flag: 'ğŸ‡¦ğŸ‡·',
    maps: {
      googleMaps: 'https://goo.gl/maps/Z9DXNxhf2o93kvyc6',
      openStreetMaps: 'https://www.openstreetmap.org/relation/286393',
    },
    population: 45376763,
    gini: { 2019: 42.9 },
    fifa: 'ARG',
    car: { signs: ['RA'], side: 'right' },
    timezones: ['UTC-03:00'],
    continents: ['South America'],
    flags: {
      png: 'https://flagcdn.com/w320/ar.png',
      svg: 'https://flagcdn.com/ar.svg',
    },
    coatOfArms: {
      png: 'https://mainfacts.com/media/images/coats_of_arms/ar.png',
      svg: 'https://mainfacts.com/media/images/coats_of_arms/ar.svg',
    },
    startOfWeek: 'monday',
    capitalInfo: { latlng: [-34.58, -58.67] },
    postalCode: { format: '@####@@@', regex: '^([A-Z]\\d{4}[A-Z]{3})$' },
  };

  const obj = {
    name: {
      common: 'Belgium',
      official: 'Kingdom of Belgium',
      nativeName: {
        deu: { official: 'KÃ¶nigreich Belgien', common: 'Belgien' },
        fra: { official: 'Royaume de Belgique', common: 'Belgique' },
        nld: { official: 'Koninkrijk BelgiÃ«', common: 'BelgiÃ«' },
      },
    },
    tld: ['.be'],
    cca2: 'BE',
    ccn3: '056',
    cca3: 'BEL',
    cioc: 'BEL',
    independent: true,
    status: 'officially-assigned',
    unMember: true,
    currencies: { EUR: { name: 'Euro', symbol: 'â‚¬' } },
    idd: { root: '+3', suffixes: ['2'] },
    capital: ['Brussels'],
    altSpellings: [
      'BE',
      'BelgiÃ«',
      'Belgie',
      'Belgien',
      'Belgique',
      'Kingdom of Belgium',
      'Koninkrijk BelgiÃ«',
      'Royaume de Belgique',
      'KÃ¶nigreich Belgien',
    ],
    region: 'Europe',
    subregion: 'Western Europe',
    languages: { deu: 'German', fra: 'French', nld: 'Dutch' },
    translations: {
      ara: { official: 'Ù…Ù…Ù„ÙƒØ© Ø¨Ù„Ø¬ÙŠÙƒØ§', common: 'Ø¨Ù„Ø¬ÙŠÙƒØ§' },
      bre: { official: 'Rouantelezh Belgia', common: 'Belgia' },
      ces: { official: 'BelgickÃ© krÃ¡lovstvÃ­', common: 'Belgie' },
      cym: { official: 'Teyrnas Gwlad Belg', common: 'Gwlad Belg' },
      deu: { official: 'KÃ¶nigreich Belgien', common: 'Belgien' },
      est: { official: 'Belgia Kuningriik', common: 'Belgia' },
      fin: { official: 'Belgian kuningaskunta', common: 'Belgia' },
      fra: { official: 'Royaume de Belgique', common: 'Belgique' },
      hrv: { official: 'Kraljevina Belgija', common: 'Belgija' },
      hun: { official: 'Belga KirÃ¡lysÃ¡g', common: 'Belgium' },
      ita: { official: 'Regno del Belgio', common: 'Belgio' },
      jpn: { official: 'ãƒ™ãƒ«ã‚®ãƒ¼ç‹å›½', common: 'ãƒ™ãƒ«ã‚®ãƒ¼' },
      kor: { official: 'ë²¨ê¸°ì— ì™•êµ­', common: 'ë²¨ê¸°ì—' },
      nld: { official: 'Koninkrijk BelgiÃ«', common: 'BelgiÃ«' },
      per: { official: 'Ù¾Ø§Ø¯Ø´Ø§Ù‡ÛŒ Ø¨Ù„Ú˜ÛŒÚ©', common: 'Ø¨Ù„Ú˜ÛŒÚ©' },
      pol: { official: 'KrÃ³lestwo Belgii', common: 'Belgia' },
      por: { official: 'Reino da BÃ©lgica', common: 'BÃ©lgica' },
      rus: { official: 'ĞšĞ¾Ñ€Ğ¾Ğ»ĞµĞ²ÑÑ‚Ğ²Ğ¾ Ğ‘ĞµĞ»ÑŒĞ³Ğ¸Ñ', common: 'Ğ‘ĞµĞ»ÑŒĞ³Ğ¸Ñ' },
      slk: { official: 'BelgickÃ© krÃ¡Ä¾ovstvo', common: 'Belgicko' },
      spa: { official: 'Reino de BÃ©lgica', common: 'BÃ©lgica' },
      swe: { official: 'Konungariket Belgien', common: 'Belgien' },
      tur: { official: 'BelÃ§ika KrallÄ±ÄŸÄ±', common: 'BelÃ§ika' },
      urd: { official: 'Ù…Ù…Ù„Ú©ØªÙ Ø¨Ù„Ø¬Ø¦ÛŒÙ…', common: 'Ø¨Ù„Ø¬Ø¦ÛŒÙ…' },
      zho: { official: 'æ¯”åˆ©æ—¶ç‹å›½', common: 'æ¯”åˆ©æ—¶' },
    },
    latlng: [50.83333333, 4],
    landlocked: false,
    borders: ['FRA', 'DEU', 'LUX', 'NLD'],
    area: 30528,
    demonyms: {
      eng: { f: 'Belgian', m: 'Belgian' },
      fra: { f: 'Belge', m: 'Belge' },
    },
    flag: 'ğŸ‡§ğŸ‡ª',
    maps: {
      googleMaps: 'https://goo.gl/maps/UQQzat85TCtPRXAL8',
      openStreetMaps: 'https://www.openstreetmap.org/relation/52411',
    },
    population: 11555997,
    gini: { 2018: 27.2 },
    fifa: 'BEL',
    car: { signs: ['B'], side: 'right' },
    timezones: ['UTC+01:00'],
    continents: ['Europe'],
    flags: {
      png: 'https://flagcdn.com/w320/be.png',
      svg: 'https://flagcdn.com/be.svg',
    },
    coatOfArms: {
      png: 'https://mainfacts.com/media/images/coats_of_arms/be.png',
      svg: 'https://mainfacts.com/media/images/coats_of_arms/be.svg',
    },
    startOfWeek: 'monday',
    capitalInfo: { latlng: [50.83, 4.33] },
    postalCode: { format: '####', regex: '^(\\d{4})$' },
  };

  return response[0];
});
